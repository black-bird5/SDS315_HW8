---
title: "SDS315_HW8"
author: "William Zuo"
date: "2025-04-09"
output:
  html_document:
    toc: true
    toc_float: true
  pdf_document:
    toc: true
---

```{r global_options, include=FALSE}
#needed packages:
library(tidyverse)
library(mosaic)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
```

# **Introduction**

My name is William Zuo and my EID is wcz82. This is where my results and solutions are contained. Here is the link to my GitHub repository containing my R code for this assignment: https://github.com/black-bird5/SDS315_HW8. 

# **Problem 1**

```{r, echo=FALSE}
creatinine <- read.csv("creatinine.csv")
ggplot(creatinine) + 
  geom_point(aes(x = age, y = creatclear)) + 
  geom_smooth(aes(x = age, y = creatclear), method = 'lm') + 
  labs(title = "Creatinine Clearance Rate by Age", x = "Age", y = "Creatinine Clearance Rate (log scale)")

model_creatinine = lm(creatclear ~ age, data = creatinine)
coef(model_creatinine)
```

### **Part A**

The creatinine clearance rate we should expect for a 55-year-old is about 113.713 mL/minute. I determined this number with the values generated by R, with the intercept being 147.813 and the rate of change based on age being -0.62. The equation I used was 147.813 - 55x0.62. 

### **Part B**

The creatinine clearance rate decreases by about 0.62 mL/minute every year someone ages. I determined this value using R, as seen generated above. 

### **Part C**

The expected creatinine clearance rate for a 40-year-old is about 123.013 mL/minute and about 110.613 mL/minute for a 60-year-old. I calculated these values using the equation 147.813 - 40x0.62 for the 40-year-old and 147.813 - 60x0.62 for the 60-year-old. A 40-year-old with a creatinine clearance rate of 135 is about 9.7% healthier than the average 40-year-old according to this model (135/123.013) while a 60-year-old with a creatinine clearance rate of 112 is only about 1.25% healthier than the average 60-year-old according to this model (112/110.613). Thus, the 40-year-old with a creatinine clearance rate rate of 135 has the healthier creatinine clearance rate for their age compared to a 60-year-old with a creatinine clearance rate of 112
 
# **Problem 2**

```{r, echo=FALSE}
covid <- read.csv("covid.csv")
```

### **Part 1**

```{r, echo=FALSE}
italy <- subset(covid, country == "Italy")

ggplot(italy) + 
  geom_point(aes(x = days_since_first_death, y = log(deaths))) + 
  geom_smooth(aes(x = days_since_first_death, y = log(deaths)), method = 'lm') + 
  labs(title = "COVID-19 Daily Deaths in Italy", x = "Days Since First Death", y = "Daily Deaths (log scale)")

boot_italy = do(10000) * lm(log(deaths) ~ days_since_first_death, data = mosaic::resample(italy))
confint(boot_italy, level = 0.95)
```

The estimated growth rate for deaths in Italy is about 0.198 deaths per day, with a 95% confidence interval of (0.159, 0.208). The estimated doubling time for deaths in Italy is `r round(log(2)/0.198,2)` days, with a 95% confidence interval of (`r round(log(2)/0.208,2)`, `r round(log(2)/0.159,2)`).

### **Part 2**

```{r, echo=FALSE}
spain <- subset(covid, country == "Spain")

ggplot(spain) + 
  geom_point(aes(x = days_since_first_death, y = log(deaths))) + 
  geom_smooth(aes(x = days_since_first_death, y = log(deaths)), method = 'lm') +
  labs(title = "COVID-19 Daily Deaths in Spain", x = "Days Since First Death", y = "Daily Deaths (log scale)")

boot_spain = do(10000) * lm(log(deaths) ~ days_since_first_death, data = mosaic::resample(spain))
confint(boot_spain, level = 0.95)
```

The estimated growth rate for deaths in Spain is about 0.284 deaths per day, with a 95% confidence interval of (0.235, 0.318).The estimated doubling time for deaths in Spain is `r round(log(2)/0.284,2)` days, with a 95% confidence interval of (`r round(log(2)/0.318,2)`, `r round(log(2)/0.235,2)`).

### **Part 3**

```{r, echo=FALSE}
ggplot(covid) + 
  geom_line(aes(x = days_since_first_death, y = log(deaths), color = country)) + 
  geom_point(aes(x = days_since_first_death, y = log(deaths), color = country)) + 
  labs(title = "COVID-19 Daily Deaths in Italy and Spain", x = "Days Since First Death", y = "Daily Deaths (log scale)", color = "Country")
```

# **Problem 3**

```{r, echo=FALSE}
milk <- read.csv("milk.csv")

ggplot(milk) + 
  geom_point(aes(x = log(price), y = log(sales))) +
  geom_smooth(aes(x = log(price), y = log(sales)), method = "lm") +
  labs(title = "Milk Sales vs Price (Log-Log Plot)", x = "Price (log scale))", y = "Sales (log scale))")

boot_milk <- do(10000) * lm(log(sales) ~ log(price), data = mosaic::resample(milk))
confint(boot_milk, level = 0.95)
```

### **Writeup**

I first converted the equation Q = KP^β into log(Q) = log(K) + βlog(P) using log rules so that I could set the price elasticity of demand as the slope in the linear regression model constructed. Using this modified equation and by bootstrapping the data collected, I found that the estimated price elasticity of demand for milk is about -1.54, with a 95% confidence interval of (-1.77, -1.46). 